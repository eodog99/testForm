<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>layout-form-test</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="reset.css">

    <script src="/common/js/jquery-3.7.1.js"></script>
    <script src="/common/js/common.js"></script>
    <!-- ibsheet css -->
    <link rel="stylesheet" href="https://demo.ibsheet.com/ibsheet/v8/samples/customer-sample/assets/css/style.css" />
    <link rel="stylesheet"
        href="https://demo.ibsheet.com/ibsheet/v8/samples/customer-sample/assets/ibsheet/css/default/main.css" />

    <!-- ibsheet í•„ìˆ˜ js -->
    <script src="https://demo.ibsheet.com/ibsheet/v8/samples/customer-sample/assets/ibsheet/ibleaders.js"></script>
    <script src="https://demo.ibsheet.com/ibsheet/v8/samples/customer-sample/assets/ibsheet/ibsheet.js"></script>
    <script src="https://demo.ibsheet.com/ibsheet/v8/samples/customer-sample/assets/ibsheet/locale/ko.js"></script>

    <!-- ibsheet í”ŒëŸ¬ê·¸ì¸ -->
    <script
        src="https://demo.ibsheet.com/ibsheet/v8/samples/customer-sample/assets/ibsheet/plugins/ibsheet-common.js"></script>
    <script
        src="https://demo.ibsheet.com/ibsheet/v8/samples/customer-sample/assets/ibsheet/plugins/ibsheet-dialog.js"></script>
    <script
        src="https://demo.ibsheet.com/ibsheet/v8/samples/customer-sample/assets/ibsheet/plugins/ibsheet-excel.js"></script>

    <!-- ì™¸ë¶€ ë¼ì´ë¸ŒëŸ¬ë¦¬ -->
    <script
        src="https://demo.ibsheet.com/ibsheet/v8/samples/customer-sample/assets/vendors/fontawesome.min.js"></script>

</head>

<!-- 
í¼ ë‚´ìš© ì •ë¦¬
ì…€ë ‰íŠ¸ , ì¸í’‹, ë‚ ì§œ, 

ë²„íŠ¼ ì¢…ë¥˜
ìƒˆì°½ ë²„íŠ¼, íŒŒì¼ ì—…ë¡œë“œ ë²„íŠ¼, í”ŒëŸ¬ìŠ¤ ë²„íŠ¼(ìˆ˜ì •í•˜ì‹ ë‹¤í•¨)? ë‹ë³´ê¸° ë²„íŠ¼

-->

<body class="body-wrap">
    <div id="header"></div>
    <main class="main-wrap">
        <div id="nav"></div>
        <!-- ê¸°ì¡´ content-wrap ì—ì„œ contentë¡œ ìˆ˜ì •, ì´ìœ ëŠ”  ì›ë˜ëŠ” progress-barë¥¼ í¬í•¨í•˜ì—¬ headë¡œ í–ˆì§€ë§Œ íƒ€ì´í‹€ë§Œ ë‚¨ê²¨ë„ ë˜ê¸°ì—...  -->
        <div class="content">
            <div class="content-head">
                <h3>ìˆ˜ê°•ì‹ ì²­</h3>
            </div>
            <div class="content-body">
                <div class="progress-bar">
                    <div class="progress-bar-item">
                        <div class="progress-bar-item__line"></div>
                        <div class="progress-bar-item__text">ì½”ë“œê²€ìƒ‰</div>
                    </div>
                    <div class="progress-bar-item">
                        <div class="progress-bar-item__line"></div>
                        <div class="progress-bar-item__text">ì½”ë“œê²€ìƒ‰</div>
                    </div>
                    <div class="progress-bar-item">
                        <div class="progress-bar-item__line"></div>
                        <div class="progress-bar-item__text">ì½”ë“œê²€ìƒ‰</div>
                    </div>
                    <div class="progress-bar-item">
                        <div class="progress-bar-item__line"></div>
                        <div class="progress-bar-item__text">ì½”ë“œê²€ìƒ‰</div>
                    </div>
                    <div class="progress-bar-item">
                        <div class="progress-bar-item__line"></div>
                        <div class="progress-bar-item__text">ì½”ë“œê²€ìƒ‰</div>
                    </div>
                    <div class="progress-bar-item">
                        <div class="progress-bar-item__line"></div>
                        <div class="progress-bar-item__text">ì½”ë“œê²€ìƒ‰</div>
                    </div>
                    <div class="progress-bar-item">
                        <div class="progress-bar-item__line"></div>
                        <div class="progress-bar-item__text">ì½”ë“œê²€ìƒ‰</div>
                    </div>
                </div>
                <div class="step-section step-section--01">
                    <!-- ul> li > dl êµ¬ì¡°: ì‹œë©˜í‹±, êµ¬ì¡° ì ‘ê·¼ì„±ì„ ì¢‹ê²Œ í•˜ê¸°ìœ„í•´ ì´ëŸ¬í•œ êµ¬ì¡°ë¡œ ì œì‘(psi í”„ë¡œì íŠ¸ ì°¸ê³ ) -->
                    <form class="form-box" style="flex: 1;">
                        <ul>
                            <!-- liëŠ” ëª©ë¡ í•­ëª©ìœ¼ë¡œ, í•­ëª© ê°„ êµ¬ë¶„ì´ ëª©ì ì„ ìœ„í•´ form-item í´ë˜ìŠ¤ëª…ì„ ë¶™ì„-->
                            <li class="form-item">
                                <dl>
                                    <!-- í•„ìˆ˜ ì…ë ¥ê°’ì€ label__required í´ë˜ìŠ¤ë¥¼ ì¶”ê°€í•´ beforeì„ í†µí•´ í‘œì‹œí•´ì¤Œ -->
                                    <!-- spanìœ¼ë¡œ ë„£ì„ì§€ beforeë¡œ ë„£ì„ì§€ ê³ ë¯¼í•˜ë‹¤ íƒœê·¸ ì¶”ê°€ë³´ë‹¨ cssë¡œ ì¡°ì •í•˜ëŠ”ê²Œ ê¹”ë”í• ê±° ê°™ì•„ì„œ labelì— í´ë˜ìŠ¤ ì¶”ê°€í•˜ê¸°ë¥¼ ì„ íƒí•¨ -->
                                    <dt class="form-item__title"><label class="label__required">select-box</label></dt>
                                    <dd class="form-item__content">
                                        <!--contentì— ë“¤ì–´ê°€ëŠ” ë‚´ìš©ì„ ...-box í˜•ì‹ìœ¼ë¡œ ê°ìŒˆ -->
                                        <div class="select-box">
                                            <select class="select" data-placeholder="ì„ íƒ" id="select" tabindex="9">
                                                <option>L : Local - êµ­ë‚´ ìƒì‚°í’ˆëª©</option>
                                                <option>ì„ íƒ</option>
                                                <option>ì„ íƒ</option>
                                                <option>ì„ íƒ</option>
                                            </select>
                                        </div>
                                    </dd>
                                </dl>
                            </li>
                            <li class="form-item">
                                <dl>
                                    <dt class="form-item__title"><label class="label__required">date-box</label></dt>
                                    <dd class="form-item__content">
                                        <div class="date-box">
                                            <input type="date" class="item__size--l">
                                        </div>
                                    </dd>
                                </dl>
                            </li>
                            <li class="form-item">
                                <dl>
                                    <dt class="form-item__title"><label>radio</label></dt>
                                    <dd class="form-item__content">
                                        <div class="radio-box">
                                            <input type="radio" class="radio" id="radio" name="radio" />
                                            <label for="radio">ë¶ˆê°€ ì‚¬ìœ  :</label>
                                        </div>
                                    </dd>
                                </dl>
                            </li>
                            <li class="form-item">
                                <dl>
                                    <dt class="form-item__title"><label>textarea-box</label></dt>
                                    <!-- ddì— ë‚´ìš©ì´ ì„¸ë¡œë¡œ ë‘ê°œ ë“¤ì–´ê°ˆë–„ -->
                                    <dd class="form-item__content">
                                        <!-- textarea-box -->
                                        <div class="textarea-box">
                                            <textarea class="textarea" id="textarea1"
                                                nameplaceholder="">10ì ì´ìƒ ì‘ì„± ë°”ëë‹ˆë‹¤.</textarea>
                                        </div>
                                    </dd>
                                </dl>
                            </li>
                            <li class="form-item">
                                <dl>
                                    <dt><label>input-btn--box</label></dt>
                                    <dd>
                                        <!--"input-box--btn: btnì´ í¬í•¨ëœ input-box -->
                                        <div class="input-box--btn">
                                            <input class="input-text" type="text" placeholder="" />
                                            <div class="search-btn">
                                                <button class="form-btn"><span>dd</span></button>
                                            </div>
                                        </div>
                                    </dd>
                                </dl>
                            </li>
                            <!-- form-item--compound: í•˜ë‚˜ì˜ form-itemì— dlì´ ë‘ê°œ ë“¤ì–´ê°ˆ ë•Œ(ê°€ë¡œ)-->
                            <li class="form-item form-item--compound">
                                <dl>
                                    <dt><label>form-item--compound</label></dt>
                                    <dd>
                                        <input value="set" readonly>
                                    </dd>
                                </dl>
                                <dl>
                                    <dt><label>MSDSì—¬ë¶€</label></dt>
                                    <dd>
                                        <input value="set" readonly>
                                    </dd>
                                </dl>
                            </li>
                            <li class="form-item">
                                <dl>
                                    <!-- label & field , title& content  -->
                                    <!-- íŒŒì¼ ì—…ë¡œë“œì— ëŒ€í•œê±´ ì•„ì§ ë¯¸ì •ì¸ë“¯
                                          ì²¨ë¶€íŒŒì¼ ì•„ì´ì½˜ í´ë¦­í•˜ë©´ ecmìœ¼ë¡œ ë“±ë¡í•˜ê¸° ìœ„í•œ íŒì—…ì´ ëœ¨ê³  íŒì—…ì•ˆì— ë‹¨ì¶”ë¥¼ ëˆ„ë¥´ë©´ ecmëœ¨ê³  ê·¸ê±¸ ëˆ„ë¥´ê³  ë˜ ë“±ë¡í•´ì•¼ ë“±ë¡ì´ ë¨ -->
                                    <dt class="form-item__title">
                                        <label>ì²¨ë¶€íŒŒì¼</label>
                                    </dt>
                                    <dd class="form-item__content flex-col">
                                        <div class="file-box">
                                            <label class="file-box__title">ì²¨ë¶€íŒŒì¼:</label>
                                            <input class="file-box__name" value="ì²¨ë¶€íŒŒì¼" placeholder="ì²¨ë¶€íŒŒì¼" readonly>
                                            <label for="file1" class="upload-btn"></label>
                                            <input type="file" id="file1" style="display: none;">
                                        </div>
                                        <div class="file-box">
                                            <label class="file-box__title">ì²¨ë¶€íŒŒì¼:</label>
                                            <input class="file-box__name" value="ì²¨ë¶€íŒŒì¼" placeholder="ì²¨ë¶€íŒŒì¼" readonly>
                                            <label for="file2" class="upload-btn"></label>
                                            <input type="file" id="file2" style="display: none;">
                                        </div>
                                        <div class="file-box">
                                            <label class="file-box__title">ì²¨ë¶€íŒŒì¼:</label>
                                            <input class="file-box__name" value="ì²¨ë¶€íŒŒì¼" placeholder="ì²¨ë¶€íŒŒì¼" readonly>
                                            <label for="file3" class="upload-btn"></label>
                                            <input type="file" id="file3" style="display: none;">
                                        </div>
                                    </dd>

                                </dl>
                            </li>
                            <li class="form-item">
                                <dl>
                                    <!-- í•„ìˆ˜ ì…ë ¥ê°’ì€ label__required í´ë˜ìŠ¤ë¥¼ ì¶”ê°€í•´ beforeì„ í†µí•´ í‘œì‹œí•´ì¤Œ -->
                                    <!-- spanìœ¼ë¡œ ë„£ì„ì§€ beforeë¡œ ë„£ì„ì§€ ê³ ë¯¼í•˜ë‹¤ íƒœê·¸ ì¶”ê°€ë³´ë‹¨ cssë¡œ ì¡°ì •í•˜ëŠ”ê²Œ ê¹”ë”í• ê±° ê°™ì•„ì„œ labelì— í´ë˜ìŠ¤ ì¶”ê°€í•˜ê¸°ë¥¼ ì„ íƒí•¨ -->
                                    <dt class="form-item__title">
                                        <label class="label__required">flex-row</label>
                                    </dt>
                                    <dd class="form-item__content flex-row">
                                        <div class="select-box item__size--s">
                                            <select class="select " data-placeholder="ì„ íƒ" id="select" tabindex="9">
                                                <option>L : Local - êµ­ë‚´ ìƒì‚°í’ˆëª©</option>
                                                <option>ì„ íƒ</option>
                                                <option>ì„ íƒ</option>
                                                <option>ì„ íƒ</option>
                                            </select>
                                        </div>
                                        <div class="input-box--btn">
                                            <input class="input-text" type="text" placeholder="" />
                                        </div>
                                        <div class="date-box item__size--s">
                                            <input type="date">
                                        </div>
                                    </dd>
                                </dl>
                            </li>

                            <li class="form-item">
                                <dl>
                                    <!-- label & field , title& content  -->
                                    <!-- íŒŒì¼ ì—…ë¡œë“œì— ëŒ€í•œê±´ ì•„ì§ ë¯¸ì •ì¸ë“¯
                                          ì²¨ë¶€íŒŒì¼ ì•„ì´ì½˜ í´ë¦­í•˜ë©´ ecmìœ¼ë¡œ ë“±ë¡í•˜ê¸° ìœ„í•œ íŒì—…ì´ ëœ¨ê³  íŒì—…ì•ˆì— ë‹¨ì¶”ë¥¼ ëˆ„ë¥´ë©´ ecmëœ¨ê³  ê·¸ê±¸ ëˆ„ë¥´ê³  ë˜ ë“±ë¡í•´ì•¼ ë“±ë¡ì´ ë¨ -->
                                    <dt class="form-item__title">
                                        <label>ë„ë©´ë²ˆí˜¸</label>
                                    </dt>
                                    <dd class="form-item__content flex-col" style="gap: 12px;">
                                        <div class="drawing-number-box">
                                            <input type="checkbox">
                                            <label>1:</label>
                                            <div class="input-box--btn">
                                                <input class="input-text" type="text" placeholder="" />
                                                <div class="search-btn">
                                                    <button class="form-btn"><span>dd</span></button>
                                                </div>
                                            </div>
                                            <label>í–‰ë²ˆ :</label>
                                            <input class="input-text" type="text" placeholder="" />
                                        </div>
                                        <div class="drawing-number-box">
                                            <input type="checkbox">
                                            <label>1:</label>
                                            <div class="input-box--btn">
                                                <input class="input-text" type="text" placeholder="" />
                                                <div class="search-btn">
                                                    <button class="form-btn"><span>dd</span></button>
                                                </div>
                                            </div>
                                            <label>í–‰ë²ˆ :</label>
                                            <input class="input-text" type="text" placeholder="" />
                                        </div>



                                    </dd>
                                </dl>
                            </li>
                            <li class="form-item">
                                <dl>
                                    <dt><label>MSDSì—¬ë¶€</label></dt>
                                    <dd class="form-item__conten flex-col">
                                        <div class="form-item__radio-group">
                                            <input type="radio" value="">
                                            <label>ë¶ˆê°€ì‚¬ìœ :</label>
                                        </div>
                                        <textarea class="form__textarea item__size--l">

                                        </textarea>
                                    </dd>
                                </dl>
                            </li>
                            <li class="form-item">
                                <dl>
                                    <dt><label>readonly</label></dt>
                                    <dd>
                                        <input value="set" readonly>
                                    </dd>
                                </dl>
                            </li>
                            <li class="form-item">
                                <dl>
                                    <!-- label & field , title& content  -->
                                    <!-- íŒŒì¼ ì—…ë¡œë“œì— ëŒ€í•œê±´ ì•„ì§ ë¯¸ì •ì¸ë“¯
                                          ì²¨ë¶€íŒŒì¼ ì•„ì´ì½˜ í´ë¦­í•˜ë©´ ecmìœ¼ë¡œ ë“±ë¡í•˜ê¸° ìœ„í•œ íŒì—…ì´ ëœ¨ê³  íŒì—…ì•ˆì— ë‹¨ì¶”ë¥¼ ëˆ„ë¥´ë©´ ecmëœ¨ê³  ê·¸ê±¸ ëˆ„ë¥´ê³  ë˜ ë“±ë¡í•´ì•¼ ë“±ë¡ì´ ë¨ -->
                                    <dt class="form-item__title">
                                        <label>ì²¨ë¶€íŒŒì¼ ì´ë¯¸ì§€</label>
                                    </dt>
                                    <dd class="form-item__content flex-col">
                                        <div class="file-box">
                                            <label class="file-box__title">ì²¨ë¶€íŒŒì¼:</label>
                                            <input class="file-box__name" value="ì²¨ë¶€íŒŒì¼" placeholder="ì²¨ë¶€íŒŒì¼" readonly>
                                            <label for="file4" class="upload-btn"></label>
                                            <input type="file" id="file4" style="display: none;">
                                            <img class="file-box__img">
                                        </div>

                                    </dd>

                                </dl>
                            </li>
                        </ul>
                    </form>

                    <div class="ibsheet-box" style="width: 100%; height: 373px">
                        <div id="sheetDiv" style="width:100%; height:310px"></div>
                    </div>

                </div>
                <div class="step-section step-section--02">
                    <div class="step-section__head">
                        <!-- <div class="step-section__title">
                            <h3 class="step-section__title-main">ìˆ˜ì •ì‹ ì²­(CPR)</h3>
                            <span class="step-section__title-sub">_ê¸°ë³¸ì •ë³´ì…ë ¥</span>
                        </div>
                        <div class="step-section__sub-text">
                            <p>í•„ìˆ˜ì…ë ¥ì¹¸(*) ì„ ëª¨ë‘ ì±„ì›Œì•¼ ë‹¤ìŒìœ¼ë¡œ ë„˜ì–´ê°ˆìˆ˜ìˆìŠµë‹ˆë‹¤</p>
                        </div> -->
                    </div>
                    <div class="step-section__body">
                        <div class="fileter-history-section">
                        </div>
                        <form class="modify-form-section">
                        </form>
                    </div>
                </div>


            </div>
            <div class="content-foot">
                <div>
                    <button>ë‹¤ìŒ</button>
                    <button>ë‹¤ìŒ</button>
                </div>
            </div>

        </div>
    </main>
    <div id="footer"></div>

</body>

<script>
    document.addEventListener("DOMContentLoaded", () => {
        const currentPath = window.location.pathname; // ex) "/layout-form/layout copy.html"

        // 3depth <a>ë“¤ì„ ìˆœíšŒ
        document.querySelectorAll(".depth3-wrap a").forEach(link => {
            const linkPath = link.getAttribute("href");

            // í˜„ì¬ ê²½ë¡œì™€ a íƒœê·¸ì˜ hrefê°€ ì¼ì¹˜í•˜ëŠ”ì§€ í™•ì¸
            if (currentPath.endsWith(linkPath)) {
                // a â†’ li â†’ ul(depth3-wrap) â†’ li â†’ ul(depth2-wrap) â†’ li(menu-item)
                link.classList.add("active"); // ë§í¬ì— í‘œì‹œ
                link.closest(".menu-item")?.classList.add("active");
                link.closest(".depth2-wrap")?.previousElementSibling?.classList.add("active"); // depth1 í‘œì‹œ
                link.closest(".depth3-wrap")?.previousElementSibling?.classList.add("active"); // depth2 í‘œì‹œ
            }
        });
    });

</script>

<script>
    var ib = ib || {};
    ib = {
        init: {
            "Cfg": {
                "SearchMode": 4,
                "SortCurrentPage": true, // searchMode 4ì¼ë–„ ì •ë ¬ ì—¬ë¶€ ì„ íƒ
                "MessageWidth": 300,
                "UseHeaderSortCancel": 1,
                "CanSort": 1,
                "PageLength": 10,
                InfoRowConfig: {
                    Visible: 1,
                    Layout: ["Paging2"], //, "Count"
                    // ViewCount: 1,
                    // ViewFormat: "10|20|30|50",
                    Paging2Count: 10,
                    Space: "Bottom"
                }
            },
            "Def": {
                "Row": {
                    "CanFormula": true
                }
            },
            LeftCols: [
                { Header: { Value: " ", HeaderCheck: 0 }, BoolGroup: "1", Type: "Bool", Name: "CheckData", Width: 40, Align: "Center", CanEdit: 1, CanSort: 0 }
            ],
            Cols: [
                { Header: "Leaf Class", Type: "Text", Name: "Leaf Class", SaveName: "LeafClass", Width: 200, Align: "Center", CanEdit: 1, CanSort: 1 },
                { Header: "ìƒì„¸ì„¤ëª…", Type: "Text", Name: "ìƒì„¸ì„¤ëª…", SaveName: "ìƒì„¸ì„¤ëª…", Width: 290, Align: "Center", CanEdit: 1, CanSort: 1 },
                { Header: "í’ˆëª…ì •ì˜ì„œ", Type: "Text", Name: "í’ˆëª…ì •ì˜ì„œ", SaveName: "í’ˆëª…ì •ì˜ì„œ", Width: 108, Align: "Center", CanEdit: 0, CanSort: 0 },
                {
                    Header: "ìœ ì‚¬í’ˆëª…", Type: "Img", Name: "ìœ ì‚¬í’ˆëª…", SaveName: "ìœ ì‚¬í’ˆëª…",
                    Width: 135, Align: "Center", CanEdit: 0,
                    Button: "Button", ToolTipText: "ìœ ì‚¬ í’ˆëª…ì„ í™•ì¸í•˜ì„¸ìš”",
                },
            ]
        },

        'event': {
            onRenderFirstFinish: function (evt) {
                var URL = './data.json';  // ë¡œì»¬ì— ê°™ì€ í´ë”ì— ë‘ëŠ” JSON íŒŒì¼ ê²½ë¡œ
                var param = {};

                if (evt.sheet.SearchMode > 1) {
                    param = {
                        url: URL,
                        method: 'GET',
                        callback: function (rtn) {
                            var rtnData = JSON.parse(rtn.data);
                            // evt.sheet.showMessageTime('<span style=\'color:black\'>ì¡°íšŒê°€ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.<br> ì „ì²´ ë°ì´í„° ê±´ìˆ˜ : ' + rtnData.Total + '</span>', 1000);
                        }
                    };
                    evt.sheet.showFilterDialog();
                    evt.sheet.doSearchPaging(param);
                }
            },
            // ì •ë ¬ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ ì¶”ê°€
            'onSort': function (sheet, col, order) {
                const colName = sheet.ColSaveName(col);
                const sortDir = order === 1 ? 'asc' : 'desc';

                if (!colName) {
                    console.warn("ì •ë ¬í•  ìˆ˜ ì—†ëŠ” ì»¬ëŸ¼ì…ë‹ˆë‹¤.");
                    return false;
                }

                fetch('./data.json')
                    .then(res => res.json())
                    .then(data => {
                        const sorted = data.Rows.sort((a, b) => {
                            const aVal = a[colName] ?? "";
                            const bVal = b[colName] ?? "";
                            return sortDir === 'asc'
                                ? (aVal > bVal ? 1 : aVal < bVal ? -1 : 0)
                                : (aVal < bVal ? 1 : aVal > bVal ? -1 : 0);
                        });

                        // ğŸ‘‰ ì •ë ¬ëœ ë°ì´í„°ë¥¼ doSearchPagingìœ¼ë¡œ ì „ë‹¬í•´ì•¼ í˜ì´ì§• ì‘ë™
                        sheet.doSearchPaging({
                            data: JSON.stringify({ Rows: sorted }),
                            method: 'POST'
                        });
                    });

                return false;
            },

            // ============ ì‹œíŠ¸ì˜ ë°ì´í„°ë¥¼ í´ë¦­í–ˆì„ë•Œ ë¡œì»¬ì— ì €ì¥ë˜ëŠ” ì´ë²¤íŠ¸ ==============
            // onClick: function (args) {
            //     const sheet = args.sheet;
            //     const row = args.row;
            //     const col = args.col;

            //     if (col === "TextData" && row.Kind === "Data") {
            //         const codeData = row.TextData;
            //         localStorage.setItem('form_code', codeData);
            //         // window.close();
            //     }

            //     if (col === "CheckData" && row.CheckData === 0) {
            //         const codeData = row.TextData;
            //         localStorage.setItem('form_code', codeData);
            //         // window.close();
            //     }
            // },
            onShowTip: function (evtParam) {
                // íˆ´íŒ ìœ ì‚¬í’ˆëª…, Leaf Classì˜ ê²½ìš°ì— ë‚˜ì˜¨ë‹¤
                if (evtParam.col === "ìœ ì‚¬í’ˆëª…") {
                    evtParam.tip = `
                            <div style="padding: 5px; text-align:center;">
                                <img src="https://cdn-icons-png.flaticon.com/512/1828/1828884.png" width="32" /><br/>
                                <span style="font-size: 12px;">ì„ íƒí•œ ìœ ì‚¬í’ˆëª…:??????????</span>*Value*
                            </div>`;
                    return evtParam.tip;
                }
                if (evtParam.col === "Leaf Class") {
                    const cellValue = evtParam.row[evtParam.col]
                    if (cellValue === "AVR") {
                        evtParam.tip = `
                            <div style="padding: 5px; text-align:center;">
                                <div style="display: flex; gap: 12px";>
                                    <img src="https://cdn-icons-png.flaticon.com/512/1828/1828884.png" width="32" /><br/>
                                    <img src="https://cdn-icons-png.flaticon.com/512/1828/1828884.png" width="32" /><br/>
                                    <img src="https://cdn-icons-png.flaticon.com/512/1828/1828884.png" width="32" /><br/>
                                </div>
                              
                                
                            </div>`;
                        return evtParam.tip;
                    }

                }

            },
        },
        'create': function () {
            var options = this.init;

            options.Events = this.event;
            IBSheet.create({
                id: 'sheet', // ìƒì„±í•  ì‹œíŠ¸ì˜ id
                el: 'sheetDiv', // ì‹œíŠ¸ë¥¼ ìƒì„±í•  Dom ê°ì²´ ë° id
                options: options, // ìƒì„±ë  ì‹œíŠ¸ì˜ ì†ì„±
            });
        },

    };
    ib.create();

</script>

<!-- ë©”ë‰´ ì ‘ê¸° ë²„íŠ¼ -->
<script>
    document.getElementById('navBtn').addEventListener('click', function () {
        const navWrap = document.querySelector('.nav-wrap');
        const content = document.querySelector('.content');
        const currentOpacity = getComputedStyle(navWrap).display;
        if (currentOpacity === 'block') {
            navWrap.style.display = 'none';
            content.style.width = '100vw';
        } else {
            navWrap.style.display = 'block';
            content.style.width = 'calc(100vw - 220px)';
        }
    });
</script>

<!--  íŒŒì¼ ì—…ë¡œë“œ ìŠ¤í¬ë¦½íŠ¸ -->
<script>
    $(document).ready(function () {
        $('.file-box').each(function (index) {
            const $box = $(this);
            const $fileInput = $box.find('input[type="file"]');
            const $uploadName = $box.find('.file-box__name');
            const $uploadBtn = $box.find('.upload-btn');
            const $previewImg = $box.find('.file-box__img');

            $fileInput.on('change', function () {
                const file = this.files[0];
                if (!file) return;

                const fileName = file.name;
                $uploadName.val(fileName);
                localStorage.setItem(`uploadFileName${index}`, fileName);

                // ì´ë¯¸ì§€ íŒŒì¼ì´ë©´ ë¯¸ë¦¬ë³´ê¸°
                if (file.type.startsWith('image/')) {
                    const reader = new FileReader();
                    reader.onload = function (e) {
                        const imageUrl = e.target.result;
                        $previewImg.attr('src', imageUrl).show();
                        localStorage.setItem(`uploadImageBase64${index}`, imageUrl);
                        $previewImg.css('background-color', '#fff');
                    };
                    reader.readAsDataURL(file);
                } else {
                    $previewImg.css('background-color', 'transparent');
                    $previewImg.hide(); // ì´ë¯¸ì§€ê°€ ì•„ë‹ˆë©´ ë¯¸ë¦¬ë³´ê¸° ìˆ¨ê¹€
                }
            });

            $uploadName.on('click', function () {
                $fileInput.trigger('click');
            });

            $uploadBtn.on('click', function () {
                $fileInput.trigger('click');
            });

            // ì €ì¥ëœ íŒŒì¼ëª… ë¶ˆëŸ¬ì˜¤ê¸°
            const savedName = localStorage.getItem(`uploadFileName${index}`);
            if (savedName) $uploadName.val(savedName);

            // ì €ì¥ëœ ì´ë¯¸ì§€ ë¶ˆëŸ¬ì˜¤ê¸°
            const savedImg = localStorage.getItem(`uploadImageBase64${index}`);
            if (savedImg) {
                $previewImg.attr('src', savedImg).show();
            }
        });
    });

</script>



<script>
    function initNavScript(containerSelector) {
        //containerSeletorì—” nav-wrapê°€ ë“¤ì–´ê°
        const container = document.querySelector(containerSelector);

        function bindDepth1Events() {
            container.querySelectorAll(".depth1-wrap").forEach((depth1) => {
                depth1.addEventListener("click", () => toggleDepth1(depth1));
            });
        }

        function toggleDepth1(element) {
            const isActive = element.classList.contains("active");
            const menuId = element.dataset.menu;

            container.querySelectorAll(".depth1-wrap").forEach((el) => {
                el.classList.remove("active");
                // el.nextElementSibling: el ë‹¤ìŒ í˜•ì œìš”ì†Œë¥¼ ì˜ë¯¸
                // ë‹¤ìŒ í˜•ì¬ ìš”ì†Œê°€ ìˆìœ¼ë©´ opení´ë˜ìŠ¤ë¥¼ ì§€ì›Œë¼ëŠ” ëœ»
                el.nextElementSibling?.classList.remove("open");
            });

            if (!isActive) {
                element.classList.add("active");
                element.nextElementSibling?.classList.add("open");

                if (menuId) activateClosedMenu(menuId);
            }
        }

        function bindDepth2Events() {
            container.querySelectorAll(".depth2-text").forEach((depth2) => {
                depth2.addEventListener("click", (e) => {
                    e.stopPropagation();
                    toggleDepth2(depth2);
                });
            });
        }

        function toggleDepth2(element) {
            const parentWrap = element.closest(".depth2-wrap");
            const isActive = element.classList.contains("active");

            parentWrap?.querySelectorAll(".depth2-text").forEach((el) => {
                el.classList.remove("active");
                el.nextElementSibling?.classList.remove("open");
            });

            if (!isActive) {
                element.classList.add("active");
                element.nextElementSibling?.classList.add("open");
            }
        }

        function bindDepth3Events() {
            container.querySelectorAll(".depth3-text a").forEach((link) => {
                link.addEventListener("click", () => {
                    const menuId = link.closest(".depth3-wrap")?.dataset.menu;
                    if (menuId) activateClosedMenu(menuId);
                });
            });
        }
        function activateMenuByURL() {
            const currentPath = window.location.pathname;
            const depth3Links = container.querySelectorAll(".depth3-wrap a");

            depth3Links.forEach(link => {
                const href = link.getAttribute("href");

                if (href && currentPath.includes(href)) {
                    // depth2-text (depth2-wrap ì•„ë˜ì— ìˆìŒ)
                    const depth2Text = link.closest(".depth2-wrap")?.querySelector(".depth2-text");
                    if (depth2Text) {
                        depth2Text.classList.add("active");
                    }

                    // depth1-wrap (.menu-item > .depth1-wrap)
                    const depth1Wrap = link.closest(".menu-item")?.querySelector(".depth1-wrap");
                    if (depth1Wrap) {
                        depth1Wrap.classList.add("active");
                        depth1Wrap.nextElementSibling?.classList.add("open"); // depth2-wrap ì—´ê¸°
                    }
                }
            });
        }

        // ì‹¤í–‰
        bindDepth1Events();
        bindDepth2Events();
        bindDepth3Events();
        activateMenuByURL();
    }
    initNavScript(".nav-wrap"); // ë‹¤ë¥¸ í˜ì´ì§€ì— ì»¤ìŠ¤í…€ nav ì ìš© ê°€ëŠ¥


    // í´ë˜ìŠ¤ë“¤ì„ ì œê±°í•¨
    function resetMenu(container) {
        container.querySelectorAll('.depth1-wrap').forEach(el => el.classList.remove('active'));
        container.querySelectorAll('.depth2.text').forEach(el => el.classList.remove('active'));
        container.querySelectorAll('.depth2-wrap, .depth3-wrap').forEach(el => el.classList.remove('open'));

    }


</script>


<!-- ìµœê·¼ í´ë¦­í•œ ë©”ë‰´ëª… ì„ íƒ -->
<script>
    //3Depth í´ë¦­ ì´ë²¤íŠ¸ ë“±ë¡  
    document.querySelectorAll('.depth3-wrap li').forEach(item => {
        item.addEventListener('click', function () {
            //this: aë¥¼ ê°€ë¦¬í‚´
            //textContent: aì˜ í…ìŠ¤íŠ¸ë§Œ ì¶”ì¶œí•œë‹¤.
            //trim ê³µë°±ì œê±° 
            saveMenuClickInfo(this.textContent.trim());
        });
    });
    // í´ë¦­í•œ aì˜ í…ìŠ¤íŠ¸ë¥¼ saveMenuClickInfoë¥¼ í†µí•´ ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì— ì €ì¥í•œë‹¤ 
    function saveMenuClickInfo(menuName) {
        // ì €ì¥ë˜ëŠ” ë™ì‹œì— ì‹œê°„ë„ ì €ì¥
        const now = new Date();
        // íƒ€ì„ìŠ¤íƒ¬í”„
        const timestamp = now.toLocaleString('ko-KR', {
            year: 'numeric', month: '2-digit', day: '2-digit',
            hour: '2-digit', minute: '2-digit', second: '2-digit'
        });

        // í´ë¦­í•œ ë©”ë‰´ ì •ë³´ë¥¼ ê°ì²´ë¡œ ë§Œë“¤ì–´ ì €ì¥í•  ì¤€ë¹„
        const newEntry = {
            name: menuName,
            time: timestamp
        };
        // localStorage.getItem('menuHistory'): ë¡œì»¬ìŠ¤í† ë¦¬ì§€ì—ì„œ í•­ëª©ì„ ëª¬ìì—´ í˜•ì¬ë¡œ ê°€ì ¸ì˜´
        // JSON.parse(...) : ë¬¸ìì—´ì„ ìë°”ìŠ¤í¬ë¦½íŠ¸ ë°°ì—´ ê°ì²´ë¡œ ë³€í™˜ 
        let menuHistory = JSON.parse(localStorage.getItem('menuHistory')) || []; // ë¹ˆë°°ì—´ë¡œ ì´ˆê¸°í™” , ì €ì¥ëœ ë°ì´í„°ê°€ ìˆìœ¼ë©´ ë¶ˆëŸ¬ì˜´
        //ê°™ì€ ë©”ë‰´ê°€ ì´ë¯¸ ìˆì„ ê²½ìš°, ê¸°ì¡´ ê²ƒì„ ë¨¼ì € ì§€ì›ë‹ˆë‹¤.
        menuHistory = menuHistory.filter(item => item.name !== menuName);
        // unshift()ëŠ” ë°°ì—´ì˜ ë§¨ ì• ìš”ì†Œë¥¼ ì¶”ê°€í•œë‹¤.(ìµœì‹  í´ë¦­ì´ ìœ„ë¡œ ì˜¤ê²Œ)
        menuHistory.unshift(newEntry);
        if (menuHistory.length > 3) { // ìµœëŒ€ ê°œìˆ˜ 3ê°œ 
            menuHistory = menuHistory.slice(0, 3); // ë°°ì—´ì˜ ì²¨ 3ê°œ ë‚¨ê¸°ê³  ë‚˜ë¨¸ì§€ ìë¦„
        }

        // ë¡œì»¬ìŠ¤í† ë¦¬ì§€ì— ë‹¤ì‹œ ì €ì¥, ë°°ì—´ì„ ë¬¸ìì—´ë¡œ ë°”ê¿”ì„œ ë‹¤ì‹œ ì €ì¥?(stringify)
        localStorage.setItem('menuHistory', JSON.stringify(menuHistory));
        renderRecentMenus(); // ì €ì¥ í›„ ë¦¬ìŠ¤íŠ¸ ë‹¤ì‹œ ê·¸ë¦¬ê¸°
    }


    function renderRecentMenus() {
        const list = document.getElementById('recentMenuList');
        if (!list) return; // ìš”ì†Œê°€ ì—†ìœ¼ë©´ í•¨ìˆ˜ ì¢…ë£Œ (ì˜¤ë¥˜ ë°©ì§€)

        const menuHistory = JSON.parse(localStorage.getItem('menuHistory')) || [];

        list.innerHTML = '';

        menuHistory.forEach(item => {
            const li = document.createElement('li');
            li.textContent = `${item.name} (${item.time})`;
            list.appendChild(li);
        });
    }




    // í˜ì´ì§€ ë¡œë”© ì‹œ ê¸°ì¡´ ëª©ë¡ í‘œì‹œ
    document.addEventListener('DOMContentLoaded', renderRecentMenus);
</script>


<script>
    document.addEventListener("DOMContentLoaded", function () {
        const currentPath = window.location.pathname;
        const depth3Links = document.querySelectorAll(".depth3-wrap li a");

        depth3Links.forEach(link => {
            const href = link.getAttribute("href");

            if (href && currentPath.includes(href)) {
                // 3depth li
                const depth3Li = link.closest("li");

                // 2depth li
                const depth2Li = depth3Li.closest("ul.depth3-wrap")?.closest("li");
                if (depth2Li) depth2Li.classList.add("active");

                // 1depth li (menu-item)
                const menuItem = depth2Li?.closest("ul.depth2-wrap")?.closest("li.menu-item");
                if (menuItem) menuItem.classList.add("active");
            }
        });
    });
</script>

</html>